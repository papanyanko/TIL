# SQL

## 知ったこと
- SELECT maps Table to Table
- viewはよく使うSELECTを永続化したもの
- サブクエリはSQL文の実行中だけ生存するSELECT
- GROUP　BY句は同値類の上で集約関数を考える、PARTITION　BYはその同値関係による同一視をばらしたもの
- クロス結合は直積、内部結合はその部分集合
- 外部結合はマスタテーブルのキーに対応するデータがないことを知りたいときに使う
- 結合は基本的に２重ループ
  - 内側のループのキーにインデックスが貼ってあればメモ化の要領でアクセス量を落とせる
  - 結合はなるべく避ける
  - どのテーブルを内部表にしてどの結合キーにインデックスを貼るかを想定しながら設計する
- サブクエリは内部ループで実行するSELECTなのでI/Oが増える
- ウィンドウ関数ならI/Oループは１回で済ませられる

## これから考えること
- SQLは複雑な更新ができない→複雑な更新が必要な要件だとバックエンドが大きくなる？
- 実行計画を人間が気にしなくても良いDBMS
- 結合の実行計画が絶対に悪い方に倒れないようにしたいというのは人間や組織の問題では
- サブクエリで困難を分割することは思考の補助線として大切だが最終的にはウィンドウ関数で包括的に統合する
  - これって写像的に考えれば一発で答にたどり着きやすいのでは
